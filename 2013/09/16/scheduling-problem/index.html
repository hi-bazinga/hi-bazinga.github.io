<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Algorithms," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="There is no silver bullet in algorithm design.

没有一种算法能普适于所有的计算问题。常见的算法有：

divide and comquer（归并排序等）
randomized algorithms（基于随机pivot的快速排序、Randomized Selection算法、Hash函数的设计等）
greedy algorithms（Dijkstra">
<meta property="og:type" content="article">
<meta property="og:title" content="用贪心算法解决Scheduling问题">
<meta property="og:url" content="http://yoursite.com/2013/09/16/scheduling-problem/index.html">
<meta property="og:site_name" content="Z.X.C">
<meta property="og:description" content="There is no silver bullet in algorithm design.

没有一种算法能普适于所有的计算问题。常见的算法有：

divide and comquer（归并排序等）
randomized algorithms（基于随机pivot的快速排序、Randomized Selection算法、Hash函数的设计等）
greedy algorithms（Dijkstra">
<meta property="og:updated_time" content="2015-03-18T15:14:37.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="用贪心算法解决Scheduling问题">
<meta name="twitter:description" content="There is no silver bullet in algorithm design.

没有一种算法能普适于所有的计算问题。常见的算法有：

divide and comquer（归并排序等）
randomized algorithms（基于随机pivot的快速排序、Randomized Selection算法、Hash函数的设计等）
greedy algorithms（Dijkstra">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2013/09/16/scheduling-problem/"/>

  <title> 用贪心算法解决Scheduling问题 | Z.X.C </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Z.X.C</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                用贪心算法解决Scheduling问题
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Veröffentlicht am</span>
            <time itemprop="dateCreated" datetime="2013-09-16T22:16:11+08:00" content="2013-09-16">
              2013-09-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">in</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Algorithms/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithms</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>There is no silver bullet in algorithm design.</p>
</blockquote>
<p>没有一种算法能普适于所有的计算问题。常见的算法有：</p>
<ul>
<li><strong>divide and comquer</strong>（归并排序等）</li>
<li><strong>randomized algorithms</strong>（基于随机pivot的快速排序、Randomized Selection算法、Hash函数的设计等）</li>
<li><strong>greedy algorithms</strong>（Dijkstra算法等）</li>
<li><strong>dynamic programming</strong>（Sequence Alignment问题、背包问题、Floyd-Warshall、最长递增子序列LIS等）</li>
</ul>
<h2 id="贪心算法"><a href="#贪心算法" class="headerlink" title="贪心算法"></a>贪心算法</h2><p>什么是贪心算法？简单地说，就是在算法执行的每一步都“目光短浅”地选择当下最好的方案，而不考虑整体效果的优劣。<br>贪心算法与分治算法相比有以下一些特点：</p>
<a id="more"></a>
<ul>
<li>算法易于构造和实现</li>
<li>易于计算时间复杂度（不同于分治法的Master Method）</li>
<li>难以证明其正确性，大多数情况下贪心算法并不正确（分治法可以用归纳法证明）</li>
</ul>
<p>证明贪心算法的正确性，一般有两种方式：</p>
<ol>
<li><strong>greedy stays ahead</strong>（类似归纳法，即证明贪心算法的每一步完成后当前解决方案是最佳的）</li>
<li><strong>exchange argument</strong>（下面证明Scheduling问题的最优解将会用到这种方法）</li>
</ol>
<h2 id="Scheduling问题"><a href="#Scheduling问题" class="headerlink" title="Scheduling问题"></a>Scheduling问题</h2><p>假设一台单核计算机要完成若干个任务，每个任务有两个属性，一个是完成任务所需要的时间t，另一个是任务的权重w（优先级），时间与权重都用正整数定义。现在要求设计计算一种完成任务的先后顺序，使得所有任务的带权完成时间之和最小。<code>注：任务的带权完成时间 = 任务权重w * 任务完成时的时间（包含之前的等待时间）</code></p>
<pre><code>举个例子：
          权重   任务时间
 T1       2        5
 T2       1        3

两种顺序方案的加权完成时间之和：
① T1,T2： 5*2+(5+3)*1=18
② T2,T1： 3*1+(3+5)*2=19
所以选择方案①
</code></pre><h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a><strong>问题分析</strong></h3><p>如果所有任务只有一个时间属性，没有权重的区分，那么显而易见，按任务时间t从小到大排序可以使<strong><em>完成时间</em></strong>之和最小。然后，现在要考虑带权重的情况，不能再简单地按优先级或任务时间进行排序，而要寻找一种兼顾权重和任务时间的排序条件。</p>
<p>我们现在来考虑这两种排序条件：</p>
<ol>
<li>w - t (权重与任务时间的差值)</li>
<li>w / t (权重与任务时间的比值)</li>
</ol>
<h3 id="使用w-t排序的正确性证明"><a href="#使用w-t排序的正确性证明" class="headerlink" title="使用w/t排序的正确性证明"></a><strong>使用w/t排序的正确性证明</strong></h3><p>设任务序列 <code>Seq=T1,T2,T3...Tn</code> 按照w/t的比值大小从高到低排序，此时加权完成时间之和为C-sum。<br>假设存在某种与序列Seq不同的排序方式 Seq* ，使得C-sum* &lt; C-sum。<br>因为<code>W1/t1 &gt; w2/t2 &gt; w3/t3 ... &gt; wn/tn</code>,所以 Seq* 中必然存在某两个相邻的任务Ti、Tj使得<strong>wi / ti &lt; wj / tj</strong>：<br><code>T1,T2,T3...Ti-1,Ti,Tj,Tj+1...Tn-1,Tn</code><br>此时我们运用<strong>exchange</strong>思想，将Ti与Tj交换位置，<strong>可以发现<code>T1...Ti-1</code>以及<code>Tj+1...Tn</code>的加权完成时间之和不变</strong>，所以，我们只要考察Ti和Tj这两个任务加权完成时间在交换前后的变化情况即可。<code>Ti,Tj</code>变成<code>Tj,Ti</code>后，Ti的加权完成时间增加了tj*wi，而Tj的加权完成时间减少了ti*wj,所以总的加权完成时间C-sum* = C-sum + tj * wi - ti * wj。又因为wi / ti &lt; wj / tj,即tj * wi &lt; ti * wj，即C-sum* &gt; C-sum ，与假设矛盾！</p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a><strong>练习</strong></h2><p><a href="https://class.coursera.org/algo2-002/lecture/index" target="_blank" rel="external">Algorithms: Design and Analysis, Part 2</a> 这门课给了一个小练习：</p>
<p>In this programming problem and the next you’ll code up the greedy algorithms from lecture for minimizing the weighted sum of completion times.. Download the text file <a href="http://spark-public.s3.amazonaws.com/algo2/datasets/jobs.txt" target="_blank" rel="external">here</a>. This file describes a set of jobs with positive and integral weights and lengths. It has the format<br>[number_of_jobs]<br>[job_1_weight] [job_1_length]<br>[job_2_weight] [job_2_length]<br>…<br>For example, the third line of the file is “74 59”, indicating that the second job has weight 74 and length 59. You should NOT assume that edge weights or lengths are distinct.</p>
<p>Q1. Your task in this problem is to run the greedy algorithm that schedules jobs in decreasing order of the difference (weight - length). Recall from lecture that this algorithm is not always optimal. IMPORTANT: if two jobs have equal difference (weight - length), you should schedule the job with higher weight first. Beware: if you break ties in a different way, you are likely to get the wrong answer. You should report the sum of weighted completion times of the resulting schedule — a positive integer — in the box below.</p>
<p>Q2. For this problem, use the same data set as in the previous problem. Your task now is to run the greedy algorithm that schedules jobs (optimally) in decreasing order of the ratio (weight/length). In this algorithm, it does not matter how you break ties. You should report the sum of weighted completion times of the resulting schedule — a positive integer — in the box below.</p>
<p>Python实现：</p>
<figure class="highlight plain"><figcaption><span>Scheduling.py</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">def diff_compare(j1,j2):</div><div class="line">    return (j1[0] - j1[1]) &gt; (j2[0] - j2[1]) or \</div><div class="line">        ((j1[0] - j1[1]) == (j2[0] - j2[1]) and j1[0] &gt; j2[0])</div><div class="line"></div><div class="line">def ratio_compare(j1,j2):</div><div class="line">    return j1[0] * j2[1] &gt; j1[1] * j2[0]</div><div class="line"></div><div class="line">def quickSort(jobs):</div><div class="line">    if len(jobs) &lt;= 1:</div><div class="line">        return jobs</div><div class="line">    i = 1</div><div class="line">    for j in range(1,len(jobs)):</div><div class="line">        if diff_compare(jobs[j],jobs[0]):   #use ratio_compare() to solve Q2</div><div class="line">            jobs[j],jobs[i] = jobs[i],jobs[j]</div><div class="line">            i += 1               </div><div class="line">    jobs[i-1],jobs[0] = jobs[0],jobs[i-1]</div><div class="line">    return quickSort(jobs[0:i-1]) + [jobs[i-1]] + quickSort(jobs[i:])</div><div class="line"></div><div class="line">f = open(&apos;jobs.txt&apos;)</div><div class="line">num_of_jobs = int(f.readline())</div><div class="line"></div><div class="line">jobs = []</div><div class="line">for line in f:</div><div class="line">    jobs.append(map(int,line.split(&apos; &apos;)))</div><div class="line"></div><div class="line">jobs = quickSort(jobs)</div><div class="line"></div><div class="line">sum_time = 0L</div><div class="line">time = 0L</div><div class="line">for i in range(0,num_of_jobs):</div><div class="line">    time += jobs[i][1]</div><div class="line">    sum_time += jobs[i][0] * time</div><div class="line"></div><div class="line">print sum_time</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Algorithms/" rel="tag">#Algorithms</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2013/03/11/gre-webapp-2/" rel="next" title="GRE 作文练习v1.1">
                <i class="fa fa-chevron-left"></i> GRE 作文练习v1.1
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2014/01/18/front-end-notes-css/" rel="prev" title="Web前端笔记 - CSS篇">
                Web前端笔记 - CSS篇 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Übersicht
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Jason Zhao" />
          <p class="site-author-name" itemprop="name">Jason Zhao</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">15</span>
              <span class="site-state-item-name">Artikel</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">Kategorien</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">Tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#贪心算法"><span class="nav-number">1.</span> <span class="nav-text">贪心算法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Scheduling问题"><span class="nav-number">2.</span> <span class="nav-text">Scheduling问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#问题分析"><span class="nav-number">2.1.</span> <span class="nav-text">问题分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用w-t排序的正确性证明"><span class="nav-number">2.2.</span> <span class="nav-text">使用w/t排序的正确性证明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习"><span class="nav-number">3.</span> <span class="nav-text">练习</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason Zhao</span>
</div>

<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
